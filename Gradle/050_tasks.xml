<section id="gradle_tasks">
	<title>Gradle Tasks</title>
	<section id="gradle_default_tasks">
		<title>Default Gradle tasks</title>
		<para>
			Gradle also offers tasks for introspection of Gradle itself, so
			a Gradle project can be analyzed by using
			Gradle's default tasks.
		</para>
		<para>
			A good example is the
			<parameter>tasks</parameter>
			task, which shows the available tasks of a project.
			When typing
			<code>gradle -q tasks</code>
			, a list of tasks is shown. This command lists the base tasks even without an
			<filename>build.gradle</filename>
			file.
		</para>
		<para>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/gradle_tasks_task.png"/>
				</imageobject>
			</mediaobject>
		</para>
		<para>
			Gradle also tries to give some guidiance for the usage of
			invoked
			tasks, as shown in the bottom of the console output.
			The
			<code>gradle tasks --all</code>
			command
			would also list dependent tasks, which are invoked before the
			actual task.
		</para>
		<para>
			When running
			<code>gradle tasks --all</code>
			the output looks quite similar to the one before, except of the
			<parameter>init</parameter>
			task, which depends on the
			<parameter>wrapper</parameter>
			task.
		</para>
	</section>

	<section id="creating_gradle_tasks">
		<title>Creating custom Gradle tasks</title>
		<para>
			In the
			<xref linkend="gradle_runbuild_buildfile" />
			section the first minimalist task
			in a
			<filename>build.gradle</filename>
			file
			has been created.
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text" href="./examples/starter/build_hello.gradle" />
			</programlisting>
		</para>
		<para>
			When running the
			<code>gradle -q tasks</code>
			task with this
			<filename>build.gradle</filename>
			file, the
			<parameter>hello</parameter>
			task will be listed under "Other tasks".
		</para>
		<para>
			<mediaobject>
				<imageobject>
					<imagedata fileref="images/gradle_starter_hello_task_command_line.png"/>
				</imageobject>
			</mediaobject>
		</para>
		<para>
			Tasks without a group are considered as private tasks.
			For instance
			the
			<guilabel>Gradle Task View</guilabel>
			of the Eclipse Gradle Plug-in hides these private tasks by
			default,
			but they can be shown by activating the right
			entry
			in the
			view's
			menu.
		</para>
		<para>
			Groups can be applied with the
			<parameter>group</parameter>
			property and a description can
			be applied by using the
			<parameter>description</parameter>
			property. In case the group already exists the
			<parameter>hello</parameter>
			task is added to it. If the group does not exist, it
			is created.
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text"
					href="./examples/tasks/build_hello_described.gradle" />
			</programlisting>
		</para>
	</section>

	<section id="gradle_task_structure">
		<title>Task structure</title>
		<para>
			Gradle has different phases, when working with tasks. First of
			all there is a configuration phase, where the
			code, which is
			specified
			directly in a task's closure, is executed. The configuration
			block is executed for every
			available
			task
			and not only for those tasks,
			which are later actually executed.
		</para>
		<para>
			After the configuration phase, the execution phase then runs the
			code inside the
			<code>doFirst</code>
			or
			<code>doLast</code>
			closures of those tasks,
			which are actually executed.
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text"
					href="./examples/tasks/configuration_phase_build.gradle" />
			</programlisting>
		</para>
		<para>
			When running
			<code>&gt; gradle -q anotherUnrelatedTask</code>
			<quote>I always get printed even though, I am not invoked</quote>
			and
			<quote>I am in the doLast execution phase</quote>
			are printed. The first statement comes from the configuration phase in which the task definition of the
			<code>onlySpecifiesCodeForConfigurationPhase</code>
			is evaluated.
		</para>
	</section>

	<section id="gradle_task_dependencies">
		<title>Task dependencies</title>
		<para>Gradle allows the definition of default tasks in the build file. These are
			executed, if no other tasks are
			specified.
			Tasks can also
			define their dependencies. Both
			settings are
			demonstrated in the
			following build file.
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text" href="./examples/starter/build.gradle" />
			</programlisting>
		</para>
		<para>
			<note>
				<para>&lt;&lt;
					is a just shortcut for the doLast action. So the
					<parameter>clean</parameter>
					task could also use &lt;&lt; instead of doLast.
				</para>
			</note>
		</para>
		<para>
			Hooking into predefined task executions for default tasks or tasks
			from plug-ins can also be done by using the
			<code>dependsOn</code>
			method.
		</para>
		<para>For instance when certain things have to be done right after the
			compilation of java code:
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text"
					href="./examples/tasks/compile_java_dep_build.gradle" />
			</programlisting>
		</para>
		<para>
			An alternative to creating a new task, which depends on the
			<code>'compileJava'</code>
			task
			, a new execution block can also be directly applied to an
			existing
			task, e.g., the
			<code>'compileJava'</code>
			task.
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text"
					href="./examples/tasks/add_action_to_existing_task_build.gradle" />
			</programlisting>
		</para>
		<para>When running the javaCompile task all actions, which have been
			applied to the javaCompile task, are run one by
			one according to the
			order they have been applied to the task.
		</para>
	</section>

	<section id="skip_gradle_tasks">
		<title>Skipping Tasks</title>
		<para>
			Skipping tasks can be done by passing a predicate closure to the
			<code>onlyIf</code>
			method of a task or by throwing a
			<code>StopExecutionException</code>
			before the actual work of a task is executed.
		</para>
		<para>
			<programlisting language="gradle">
				<xi:include xmlns:xi="http://www.w3.org/2001/XInclude" parse="text" href="./examples/tasks/skip_tasks_build.gradle" />
			</programlisting>
		</para>
		<para>
			<note>
				<para>
					Tasks depending on the eclipse task will be run even, if a
					<code>StopExecutionException</code>
					is thrown.
				</para>
			</note>
		</para>
	</section>
</section>
